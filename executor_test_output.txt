FAIL src/commands/loop-fixes/executor.test.js
  src/commands/loop-fixes/executor.js
    countPendingItems()
      âœ“ should return 0 when file does not exist (3 ms)
      âœ“ should return 0 when file is empty (2 ms)
      âœ“ should count pending items correctly
      âœ“ should return 0 when all items are completed
      âœ“ should handle read errors gracefully (3 ms)
    countCompletedItems()
      âœ“ should return 0 when file does not exist
      âœ“ should count completed items correctly (1 ms)
      âœ“ should handle case-insensitive [X] markers
    initializeFolder()
      âœ“ should create .claudiomiro folder if it does not exist (1 ms)
      âœ“ should not create folder if it already exists
      âœ“ should call state.setFolder if claudiomiroFolder is not defined
    loopFixes()
      âœ“ should throw error when prompt is empty (20 ms)
      âœ“ should throw error when prompt is null
      âœ“ should throw error when prompt is only whitespace (1 ms)
      âœ“ should throw error when prompt.md is not found
      âœ“ should throw error when verification-prompt.md is not found
      âœ“ should complete successfully after verification passes (CRITICAL_REVIEW_OVERVIEW.md + CRITICAL_REVIEW_PASSED.md) (1 ms)
      âœ“ should continue loop when verification finds new tasks (5 ms)
      âœ“ should iterate multiple times until CRITICAL_REVIEW_OVERVIEW.md is created then verify (2 ms)
      âœ“ should throw error when max iterations reached without completion (1 ms)
      âœ“ should throw error when max iterations reached during verification (2 ms)
      âœ“ should handle Claude execution failure (1 ms)
      âœ“ should replace placeholders in prompt template (1 ms)
      âœ“ should replace placeholders in verification prompt template (5 ms)
      âœ“ should handle unlimited iterations (Infinity) (1 ms)
      âœ“ should log iteration progress
      âœ“ should log summary when issues were fixed
      âœ“ should truncate long prompts in log output
      âœ“ should display pending and completed counts during iteration
      âœ• should delete CRITICAL_REVIEW_OVERVIEW.md when entering verification mode (2 ms)

  â— src/commands/loop-fixes/executor.js â€º loopFixes() â€º should delete CRITICAL_REVIEW_OVERVIEW.md when entering verification mode

    expect(jest.fn()).toHaveBeenCalledWith(...expected)

    Expected: StringContaining "Starting verification"
    Received
           1: "ðŸ”„ Starting loop-fixes..."
           2: "ðŸ“ Prompt: \"Test prompt\""
           3: "ðŸ”„ Max iterations: 10"

    Number of calls: 14

      752 |
      753 |             expect(fs.unlinkSync).toHaveBeenCalledWith(expect.stringContaining('CRITICAL_REVIEW_OVERVIEW.md'));
    > 754 |             expect(logger.info).toHaveBeenCalledWith(expect.stringContaining('Starting verification'));
          |                                 ^
      755 |         });
      756 |     });
      757 | });

      at Object.toHaveBeenCalledWith (src/commands/loop-fixes/executor.test.js:754:33)

Test Suites: 1 failed, 1 total
Tests:       1 failed, 29 passed, 30 total
Snapshots:   0 total
Time:        0.67 s, estimated 2 s
Ran all test suites matching /src\/commands\/loop-fixes\/executor.test.js/i.
